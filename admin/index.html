
<!-- 전체 열 포함 + 수정/삭제는 시각만 -->
<div class="summary" style="margin-top: 40px;">
  <h3>📋 등록된 문서 목록</h3>
  <table border="1" width="100%" id="docTable" style="border-collapse: collapse; text-align: center;">
    <thead>
      <tr style="background-color:#eee;">
        <th>카테고리</th>
        <th>서브카테고리</th>
        <th>코드</th>
        <th>문서명</th>
        <th>설명</th>
        <th>PDF</th>
        <th>HWP</th>
        <th>DOC</th>
        <th>XLS</th>
        <th>등록일시</th>
        <th>수정</th>
        <th>삭제</th>
      </tr>
    </thead>
    <tbody id="docTableBody"></tbody>
  </table>
</div>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/1ArWSlu-d2Dhuetegh15BupGz_IG2bPFisEhDje1qowM/gviz/tq?sheet=시트1&tqx=out:json";

function safe(r, i) {
  return r[i] && r[i].v ? r[i].v : "";
}

function loadDocuments() {
  fetch(sheetURL)
    .then(res => res.text())
    .then(data => {
      const json = JSON.parse(data.substr(47).slice(0, -2));
      const rows = json.table.rows;
      const tbody = document.getElementById("docTableBody");
      tbody.innerHTML = "";

      rows.slice(1).forEach((row, i) => {
        const r = row.c;
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><input value="${safe(r,0)}" /></td>
          <td><input value="${safe(r,1)}" /></td>
          <td><input value="${safe(r,2)}" /></td>
          <td><input value="${safe(r,3)}" /></td>
          <td><input value="${safe(r,4)}" /></td>
          <td><input value="${safe(r,5)}" /></td>
          <td><input value="${safe(r,6)}" /></td>
          <td><input value="${safe(r,7)}" /></td>
          <td><input value="${safe(r,8)}" /></td>
          <td>${safe(r,9)}</td>
          <td><button onclick="updateRow(${i + 2}, this)">💾</button></td>
          <td><button onclick="deleteRow(${i + 2})">🗑</button></td>
        `;
        tbody.appendChild(tr);
      });
    });
}

function updateRow(rowIndex, btn) {
  alert("수정 기능은 이후 Apps Script로 연결 가능합니다.");
}

function deleteRow(rowIndex) {
  alert("삭제 기능은 이후 Apps Script로 연결 가능합니다.");
}

window.onload = loadDocuments;
</script>
